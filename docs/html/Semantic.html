<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Semantic</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">HTC API Documentation</span><ul class="links" id="page-menu"><li><a href="src/Semantic.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr></table><p class="caption">Semantic</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Module providing semantic analysis and type checking for a simple functional language.
 It includes desugaring of top-level lambdas, semantic error checking, and Hindley-Milner
 type inference with support for Case, Let, and generic application.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:desugarDecl">desugarDecl</a> :: <a href="Syntax.html#t:Decl" title="Syntax">Decl</a> -&gt; <a href="Syntax.html#t:Decl" title="Syntax">Decl</a></li><li class="src short"><a href="#v:desugarProgram">desugarProgram</a> :: <a href="Syntax.html#t:Program" title="Syntax">Program</a> -&gt; <a href="Syntax.html#t:Program" title="Syntax">Program</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:SemanticError">SemanticError</a><ul class="subs"><li>= <a href="#v:UndefinedVar">UndefinedVar</a> <a href="Syntax.html#t:Ident" title="Syntax">Ident</a></li><li>| <a href="#v:ArityMismatch">ArityMismatch</a> <a href="Syntax.html#t:Ident" title="Syntax">Ident</a> Int Int</li><li>| <a href="#v:DuplicateFunc">DuplicateFunc</a> <a href="Syntax.html#t:Ident" title="Syntax">Ident</a></li><li>| <a href="#v:DuplicateParam">DuplicateParam</a> <a href="Syntax.html#t:Ident" title="Syntax">Ident</a></li><li>| <a href="#v:DuplicatePatternVar">DuplicatePatternVar</a> <a href="Syntax.html#t:Ident" title="Syntax">Ident</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:TypeError">TypeError</a><ul class="subs"><li>= <a href="#v:Mismatch">Mismatch</a> <a href="Syntax.html#t:Expr" title="Syntax">Expr</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></li><li>| <a href="#v:CondNotBool">CondNotBool</a> <a href="Syntax.html#t:Expr" title="Syntax">Expr</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></li><li>| <a href="#v:BranchesTypeDiffer">BranchesTypeDiffer</a> <a href="Syntax.html#t:Expr" title="Syntax">Expr</a> <a href="Syntax.html#t:Expr" title="Syntax">Expr</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></li><li>| <a href="#v:BinOpTypeErr">BinOpTypeErr</a> <a href="Syntax.html#t:BinOperator" title="Syntax">BinOperator</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></li><li>| <a href="#v:UnOpTypeErr">UnOpTypeErr</a> <a href="Syntax.html#t:UnOperator" title="Syntax">UnOperator</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></li><li>| <a href="#v:UnknownVar">UnknownVar</a> <a href="Syntax.html#t:Ident" title="Syntax">Ident</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Error">Error</a><ul class="subs"><li>= <a href="#v:SemErr">SemErr</a> <a href="Semantic.html#t:SemanticError" title="Semantic">SemanticError</a></li><li>| <a href="#v:TypErr">TypErr</a> <a href="Semantic.html#t:TypeError" title="Semantic">TypeError</a></li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:Sig">Sig</a> = Map <a href="Syntax.html#t:Ident" title="Syntax">Ident</a> Int</li><li class="src short"><span class="keyword">type</span> <a href="#t:Env">Env</a> = Set <a href="Syntax.html#t:Ident" title="Syntax">Ident</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:Type">Type</a><ul class="subs"><li>= <a href="#v:TInt">TInt</a></li><li>| <a href="#v:TFloat">TFloat</a></li><li>| <a href="#v:TBool">TBool</a></li><li>| <a href="#v:TChar">TChar</a></li><li>| <a href="#v:TString">TString</a></li><li>| <a href="#v:TList">TList</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></li><li>| <a href="#v:TTuple">TTuple</a> [<a href="Semantic.html#t:Type" title="Semantic">Type</a>]</li><li>| <a href="#v:TVar">TVar</a> String</li><li>| <a href="#v:TFun">TFun</a> [<a href="Semantic.html#t:Type" title="Semantic">Type</a>] <a href="Semantic.html#t:Type" title="Semantic">Type</a></li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:TypeEnv">TypeEnv</a> = Map <a href="Syntax.html#t:Ident" title="Syntax">Ident</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:FuncEnv">FuncEnv</a> = Map <a href="Syntax.html#t:Ident" title="Syntax">Ident</a> ([<a href="Semantic.html#t:Type" title="Semantic">Type</a>], <a href="Semantic.html#t:Type" title="Semantic">Type</a>)</li><li class="src short"><span class="keyword">data</span> <a href="#t:InferState">InferState</a> = <a href="#v:InferState">InferState</a> {<ul class="subs"><li><a href="#v:count">count</a> :: Int</li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:Infer">Infer</a> a = ExceptT <a href="Semantic.html#t:TypeError" title="Semantic">TypeError</a> (State <a href="Semantic.html#t:InferState" title="Semantic">InferState</a>) a</li><li class="src short"><a href="#v:buildSig">buildSig</a> :: [<a href="Syntax.html#t:Decl" title="Syntax">Decl</a>] -&gt; <a href="Semantic.html#t:Sig" title="Semantic">Sig</a></li><li class="src short"><a href="#v:buildFuncEnv">buildFuncEnv</a> :: [<a href="Syntax.html#t:Decl" title="Syntax">Decl</a>] -&gt; <a href="Semantic.html#t:FuncEnv" title="Semantic">FuncEnv</a></li><li class="src short"><a href="#v:semanticCheck">semanticCheck</a> :: <a href="Syntax.html#t:Program" title="Syntax">Program</a> -&gt; [<a href="Semantic.html#t:Error" title="Semantic">Error</a>]</li><li class="src short"><a href="#v:checkDecl">checkDecl</a> :: <a href="Semantic.html#t:Sig" title="Semantic">Sig</a> -&gt; <a href="Syntax.html#t:Decl" title="Syntax">Decl</a> -&gt; [<a href="Semantic.html#t:SemanticError" title="Semantic">SemanticError</a>]</li><li class="src short"><a href="#v:checkExpr">checkExpr</a> :: <a href="Semantic.html#t:Sig" title="Semantic">Sig</a> -&gt; <a href="Semantic.html#t:Env" title="Semantic">Env</a> -&gt; <a href="Syntax.html#t:Expr" title="Syntax">Expr</a> -&gt; [<a href="Semantic.html#t:SemanticError" title="Semantic">SemanticError</a>]</li><li class="src short"><a href="#v:checkAlt">checkAlt</a> :: <a href="Semantic.html#t:Sig" title="Semantic">Sig</a> -&gt; <a href="Semantic.html#t:Env" title="Semantic">Env</a> -&gt; (<a href="Syntax.html#t:Pattern" title="Syntax">Pattern</a>, <a href="Syntax.html#t:Expr" title="Syntax">Expr</a>) -&gt; [<a href="Semantic.html#t:SemanticError" title="Semantic">SemanticError</a>]</li><li class="src short"><a href="#v:flattenApp">flattenApp</a> :: <a href="Syntax.html#t:Expr" title="Syntax">Expr</a> -&gt; (<a href="Syntax.html#t:Expr" title="Syntax">Expr</a>, [<a href="Syntax.html#t:Expr" title="Syntax">Expr</a>])</li><li class="src short"><a href="#v:patVars">patVars</a> :: <a href="Syntax.html#t:Pattern" title="Syntax">Pattern</a> -&gt; [<a href="Syntax.html#t:Ident" title="Syntax">Ident</a>]</li><li class="src short"><a href="#v:checkProgram">checkProgram</a> :: <a href="Syntax.html#t:Program" title="Syntax">Program</a> -&gt; [<a href="Semantic.html#t:Error" title="Semantic">Error</a>]</li><li class="src short"><a href="#v:unifyReturn">unifyReturn</a> :: <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Infer" title="Semantic">Infer</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></li><li class="src short"><a href="#v:inferExpr">inferExpr</a> :: <a href="Semantic.html#t:FuncEnv" title="Semantic">FuncEnv</a> -&gt; <a href="Semantic.html#t:TypeEnv" title="Semantic">TypeEnv</a> -&gt; <a href="Syntax.html#t:Expr" title="Syntax">Expr</a> -&gt; <a href="Semantic.html#t:Infer" title="Semantic">Infer</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></li><li class="src short"><a href="#v:match">match</a> :: <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; Bool</li><li class="src short"><a href="#v:resolve">resolve</a> :: <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a></li><li class="src short"><a href="#v:inferPattern">inferPattern</a> :: <a href="Syntax.html#t:Pattern" title="Syntax">Pattern</a> -&gt; <a href="Semantic.html#t:Infer" title="Semantic">Infer</a> ([(<a href="Syntax.html#t:Ident" title="Syntax">Ident</a>, <a href="Semantic.html#t:Type" title="Semantic">Type</a>)], <a href="Semantic.html#t:Type" title="Semantic">Type</a>)</li><li class="src short"><a href="#v:literalType">literalType</a> :: <a href="Syntax.html#t:Literal" title="Syntax">Literal</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a></li><li class="src short"><a href="#v:numBin">numBin</a> :: <a href="Syntax.html#t:BinOperator" title="Syntax">BinOperator</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Infer" title="Semantic">Infer</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></li><li class="src short"><a href="#v:boolBin">boolBin</a> :: <a href="Syntax.html#t:BinOperator" title="Syntax">BinOperator</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Infer" title="Semantic">Infer</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></li><li class="src short"><a href="#v:compBin">compBin</a> :: <a href="Syntax.html#t:BinOperator" title="Syntax">BinOperator</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Infer" title="Semantic">Infer</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></li><li class="src short"><a href="#v:ensureBool">ensureBool</a> :: <a href="Syntax.html#t:Expr" title="Syntax">Expr</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Infer" title="Semantic">Infer</a> ()</li><li class="src short"><a href="#v:freshTypeVar">freshTypeVar</a> :: <a href="Semantic.html#t:Infer" title="Semantic">Infer</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></li><li class="src short"><a href="#v:isPoly">isPoly</a> :: <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; Bool</li><li class="src short"><a href="#v:checkAll">checkAll</a> :: <a href="Syntax.html#t:Program" title="Syntax">Program</a> -&gt; [<a href="Semantic.html#t:Error" title="Semantic">Error</a>]</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:desugarDecl" class="def">desugarDecl</a> :: <a href="Syntax.html#t:Decl" title="Syntax">Decl</a> -&gt; <a href="Syntax.html#t:Decl" title="Syntax">Decl</a> <a href="src/Semantic.html#desugarDecl" class="link">Source</a> <a href="#v:desugarDecl" class="selflink">#</a></p><div class="doc"><p>Perform desugaring only when the function has no parameters
 and its body is a lambda abstraction.</p><p>Transform a top-level function declaration with a lambda body
 into an equivalent declaration with explicit parameters.</p></div></div><div class="top"><p class="src"><a id="v:desugarProgram" class="def">desugarProgram</a> :: <a href="Syntax.html#t:Program" title="Syntax">Program</a> -&gt; <a href="Syntax.html#t:Program" title="Syntax">Program</a> <a href="src/Semantic.html#desugarProgram" class="link">Source</a> <a href="#v:desugarProgram" class="selflink">#</a></p><div class="doc"><p>Desugar each declaration in the program.</p><p>Apply desugaring to all declarations in a program.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SemanticError" class="def">SemanticError</a> <a href="src/Semantic.html#SemanticError" class="link">Source</a> <a href="#t:SemanticError" class="selflink">#</a></p><div class="doc"><p>Semantic errors detected during scope and arity checking.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:UndefinedVar" class="def">UndefinedVar</a> <a href="Syntax.html#t:Ident" title="Syntax">Ident</a></td><td class="doc"><p>Variable used without definition</p></td></tr><tr><td class="src"><a id="v:ArityMismatch" class="def">ArityMismatch</a> <a href="Syntax.html#t:Ident" title="Syntax">Ident</a> Int Int</td><td class="doc"><p>Function called with wrong number of arguments</p></td></tr><tr><td class="src"><a id="v:DuplicateFunc" class="def">DuplicateFunc</a> <a href="Syntax.html#t:Ident" title="Syntax">Ident</a></td><td class="doc"><p>Function name defined more than once</p></td></tr><tr><td class="src"><a id="v:DuplicateParam" class="def">DuplicateParam</a> <a href="Syntax.html#t:Ident" title="Syntax">Ident</a></td><td class="doc"><p>Parameter name appears multiple times in declaration</p></td></tr><tr><td class="src"><a id="v:DuplicatePatternVar" class="def">DuplicatePatternVar</a> <a href="Syntax.html#t:Ident" title="Syntax">Ident</a></td><td class="doc"><p>Pattern variable appears multiple times in the same pattern</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:SemanticError">Instances</h4><details id="i:SemanticError" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SemanticError:Show:1"></span> Show <a href="Semantic.html#t:SemanticError" title="Semantic">SemanticError</a></span> <a href="src/Semantic.html#line-44" class="link">Source</a> <a href="#t:SemanticError" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SemanticError:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Semantic.html">Semantic</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Semantic.html#t:SemanticError" title="Semantic">SemanticError</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Semantic.html#t:SemanticError" title="Semantic">SemanticError</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Semantic.html#t:SemanticError" title="Semantic">SemanticError</a>] -&gt; ShowS</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SemanticError:Eq:2"></span> Eq <a href="Semantic.html#t:SemanticError" title="Semantic">SemanticError</a></span> <a href="src/Semantic.html#line-44" class="link">Source</a> <a href="#t:SemanticError" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SemanticError:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Semantic.html">Semantic</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Semantic.html#t:SemanticError" title="Semantic">SemanticError</a> -&gt; <a href="Semantic.html#t:SemanticError" title="Semantic">SemanticError</a> -&gt; Bool</p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Semantic.html#t:SemanticError" title="Semantic">SemanticError</a> -&gt; <a href="Semantic.html#t:SemanticError" title="Semantic">SemanticError</a> -&gt; Bool</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:TypeError" class="def">TypeError</a> <a href="src/Semantic.html#TypeError" class="link">Source</a> <a href="#t:TypeError" class="selflink">#</a></p><div class="doc"><p>Type errors detected during type inference and checking.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Mismatch" class="def">Mismatch</a> <a href="Syntax.html#t:Expr" title="Syntax">Expr</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></td><td class="doc"><p>Expression has unexpected type</p></td></tr><tr><td class="src"><a id="v:CondNotBool" class="def">CondNotBool</a> <a href="Syntax.html#t:Expr" title="Syntax">Expr</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></td><td class="doc"><p>Condition expression is not boolean</p></td></tr><tr><td class="src"><a id="v:BranchesTypeDiffer" class="def">BranchesTypeDiffer</a> <a href="Syntax.html#t:Expr" title="Syntax">Expr</a> <a href="Syntax.html#t:Expr" title="Syntax">Expr</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></td><td class="doc"><p>Then/else branches have different types</p></td></tr><tr><td class="src"><a id="v:BinOpTypeErr" class="def">BinOpTypeErr</a> <a href="Syntax.html#t:BinOperator" title="Syntax">BinOperator</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></td><td class="doc"><p>Binary operator applied to incompatible types</p></td></tr><tr><td class="src"><a id="v:UnOpTypeErr" class="def">UnOpTypeErr</a> <a href="Syntax.html#t:UnOperator" title="Syntax">UnOperator</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></td><td class="doc"><p>Unary operator applied to non-matching type</p></td></tr><tr><td class="src"><a id="v:UnknownVar" class="def">UnknownVar</a> <a href="Syntax.html#t:Ident" title="Syntax">Ident</a></td><td class="doc"><p>Variable not found in type environment</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:TypeError">Instances</h4><details id="i:TypeError" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TypeError:Show:1"></span> Show <a href="Semantic.html#t:TypeError" title="Semantic">TypeError</a></span> <a href="src/Semantic.html#line-54" class="link">Source</a> <a href="#t:TypeError" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TypeError:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Semantic.html">Semantic</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Semantic.html#t:TypeError" title="Semantic">TypeError</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Semantic.html#t:TypeError" title="Semantic">TypeError</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Semantic.html#t:TypeError" title="Semantic">TypeError</a>] -&gt; ShowS</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Error" class="def">Error</a> <a href="src/Semantic.html#Error" class="link">Source</a> <a href="#t:Error" class="selflink">#</a></p><div class="doc"><p>Combined error type for semantic or type errors.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SemErr" class="def">SemErr</a> <a href="Semantic.html#t:SemanticError" title="Semantic">SemanticError</a></td><td class="doc"><p>A semantic error occurred</p></td></tr><tr><td class="src"><a id="v:TypErr" class="def">TypErr</a> <a href="Semantic.html#t:TypeError" title="Semantic">TypeError</a></td><td class="doc"><p>A type error occurred</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Error">Instances</h4><details id="i:Error" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Error:Show:1"></span> Show <a href="Semantic.html#t:Error" title="Semantic">Error</a></span> <a href="src/Semantic.html#line-60" class="link">Source</a> <a href="#t:Error" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Error:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Semantic.html">Semantic</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Semantic.html#t:Error" title="Semantic">Error</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Semantic.html#t:Error" title="Semantic">Error</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Semantic.html#t:Error" title="Semantic">Error</a>] -&gt; ShowS</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Sig" class="def">Sig</a> = Map <a href="Syntax.html#t:Ident" title="Syntax">Ident</a> Int <a href="src/Semantic.html#Sig" class="link">Source</a> <a href="#t:Sig" class="selflink">#</a></p><div class="doc"><p>Signature mapping function identifiers to their arity.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Env" class="def">Env</a> = Set <a href="Syntax.html#t:Ident" title="Syntax">Ident</a> <a href="src/Semantic.html#Env" class="link">Source</a> <a href="#t:Env" class="selflink">#</a></p><div class="doc"><p>Environment of variables currently in scope.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Type" class="def">Type</a> <a href="src/Semantic.html#Type" class="link">Source</a> <a href="#t:Type" class="selflink">#</a></p><div class="doc"><p>Types in the language, including base types, lists, tuples, type variables, and function types.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TInt" class="def">TInt</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:TFloat" class="def">TFloat</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:TBool" class="def">TBool</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:TChar" class="def">TChar</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:TString" class="def">TString</a></td><td class="doc"><p>Primitive types</p></td></tr><tr><td class="src"><a id="v:TList" class="def">TList</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a></td><td class="doc"><p>Homogeneous list types</p></td></tr><tr><td class="src"><a id="v:TTuple" class="def">TTuple</a> [<a href="Semantic.html#t:Type" title="Semantic">Type</a>]</td><td class="doc"><p>Tuple types with fixed arity</p></td></tr><tr><td class="src"><a id="v:TVar" class="def">TVar</a> String</td><td class="doc"><p>Type variable for inference</p></td></tr><tr><td class="src"><a id="v:TFun" class="def">TFun</a> [<a href="Semantic.html#t:Type" title="Semantic">Type</a>] <a href="Semantic.html#t:Type" title="Semantic">Type</a></td><td class="doc"><p>Function type with argument types and return type</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Type">Instances</h4><details id="i:Type" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Type:Show:1"></span> Show <a href="Semantic.html#t:Type" title="Semantic">Type</a></span> <a href="src/Semantic.html#line-79" class="link">Source</a> <a href="#t:Type" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Type:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Semantic.html">Semantic</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Semantic.html#t:Type" title="Semantic">Type</a>] -&gt; ShowS</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Type:Eq:2"></span> Eq <a href="Semantic.html#t:Type" title="Semantic">Type</a></span> <a href="src/Semantic.html#line-79" class="link">Source</a> <a href="#t:Type" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Type:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Semantic.html">Semantic</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; Bool</p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; Bool</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:TypeEnv" class="def">TypeEnv</a> = Map <a href="Syntax.html#t:Ident" title="Syntax">Ident</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a> <a href="src/Semantic.html#TypeEnv" class="link">Source</a> <a href="#t:TypeEnv" class="selflink">#</a></p><div class="doc"><p>Typing environment: map from identifiers to their inferred types.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FuncEnv" class="def">FuncEnv</a> = Map <a href="Syntax.html#t:Ident" title="Syntax">Ident</a> ([<a href="Semantic.html#t:Type" title="Semantic">Type</a>], <a href="Semantic.html#t:Type" title="Semantic">Type</a>) <a href="src/Semantic.html#FuncEnv" class="link">Source</a> <a href="#t:FuncEnv" class="selflink">#</a></p><div class="doc"><p>Function environment: map from top-level function names to their argument types and return type.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:InferState" class="def">InferState</a> <a href="src/Semantic.html#InferState" class="link">Source</a> <a href="#t:InferState" class="selflink">#</a></p><div class="doc"><p>State for generating fresh type variables during inference.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:InferState" class="def">InferState</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:count" class="def">count</a> :: Int</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Infer" class="def">Infer</a> a = ExceptT <a href="Semantic.html#t:TypeError" title="Semantic">TypeError</a> (State <a href="Semantic.html#t:InferState" title="Semantic">InferState</a>) a <a href="src/Semantic.html#Infer" class="link">Source</a> <a href="#t:Infer" class="selflink">#</a></p><div class="doc"><p>Inference monad combining state for fresh variables and error handling.</p></div></div><div class="top"><p class="src"><a id="v:buildSig" class="def">buildSig</a> :: [<a href="Syntax.html#t:Decl" title="Syntax">Decl</a>] -&gt; <a href="Semantic.html#t:Sig" title="Semantic">Sig</a> <a href="src/Semantic.html#buildSig" class="link">Source</a> <a href="#v:buildSig" class="selflink">#</a></p><div class="doc"><p>Build a signature from a list of function declarations.
 Records arity for each function, ignoring duplicates.</p></div></div><div class="top"><p class="src"><a id="v:buildFuncEnv" class="def">buildFuncEnv</a> :: [<a href="Syntax.html#t:Decl" title="Syntax">Decl</a>] -&gt; <a href="Semantic.html#t:FuncEnv" title="Semantic">FuncEnv</a> <a href="src/Semantic.html#buildFuncEnv" class="link">Source</a> <a href="#v:buildFuncEnv" class="selflink">#</a></p><div class="doc"><p>Create an initial function environment using fresh type variables for arguments and return.</p></div></div><div class="top"><p class="src"><a id="v:semanticCheck" class="def">semanticCheck</a> :: <a href="Syntax.html#t:Program" title="Syntax">Program</a> -&gt; [<a href="Semantic.html#t:Error" title="Semantic">Error</a>] <a href="src/Semantic.html#semanticCheck" class="link">Source</a> <a href="#v:semanticCheck" class="selflink">#</a></p><div class="doc"><p>Perform semantic checks (undefined variables, arity, duplicates) on a program.</p></div></div><div class="top"><p class="src"><a id="v:checkDecl" class="def">checkDecl</a> :: <a href="Semantic.html#t:Sig" title="Semantic">Sig</a> -&gt; <a href="Syntax.html#t:Decl" title="Syntax">Decl</a> -&gt; [<a href="Semantic.html#t:SemanticError" title="Semantic">SemanticError</a>] <a href="src/Semantic.html#checkDecl" class="link">Source</a> <a href="#v:checkDecl" class="selflink">#</a></p><div class="doc"><p>Check a single function declaration for semantic errors.</p></div></div><div class="top"><p class="src"><a id="v:checkExpr" class="def">checkExpr</a> :: <a href="Semantic.html#t:Sig" title="Semantic">Sig</a> -&gt; <a href="Semantic.html#t:Env" title="Semantic">Env</a> -&gt; <a href="Syntax.html#t:Expr" title="Syntax">Expr</a> -&gt; [<a href="Semantic.html#t:SemanticError" title="Semantic">SemanticError</a>] <a href="src/Semantic.html#checkExpr" class="link">Source</a> <a href="#v:checkExpr" class="selflink">#</a></p><div class="doc"><p>Recursively check an expression for semantic errors given current signature and environment.</p></div></div><div class="top"><p class="src"><a id="v:checkAlt" class="def">checkAlt</a> :: <a href="Semantic.html#t:Sig" title="Semantic">Sig</a> -&gt; <a href="Semantic.html#t:Env" title="Semantic">Env</a> -&gt; (<a href="Syntax.html#t:Pattern" title="Syntax">Pattern</a>, <a href="Syntax.html#t:Expr" title="Syntax">Expr</a>) -&gt; [<a href="Semantic.html#t:SemanticError" title="Semantic">SemanticError</a>] <a href="src/Semantic.html#checkAlt" class="link">Source</a> <a href="#v:checkAlt" class="selflink">#</a></p><div class="doc"><p>Check a case alternative for duplicate pattern variables and nested errors.</p></div></div><div class="top"><p class="src"><a id="v:flattenApp" class="def">flattenApp</a> :: <a href="Syntax.html#t:Expr" title="Syntax">Expr</a> -&gt; (<a href="Syntax.html#t:Expr" title="Syntax">Expr</a>, [<a href="Syntax.html#t:Expr" title="Syntax">Expr</a>]) <a href="src/Semantic.html#flattenApp" class="link">Source</a> <a href="#v:flattenApp" class="selflink">#</a></p><div class="doc"><p>Flatten nested applications into function and argument list.</p></div></div><div class="top"><p class="src"><a id="v:patVars" class="def">patVars</a> :: <a href="Syntax.html#t:Pattern" title="Syntax">Pattern</a> -&gt; [<a href="Syntax.html#t:Ident" title="Syntax">Ident</a>] <a href="src/Semantic.html#patVars" class="link">Source</a> <a href="#v:patVars" class="selflink">#</a></p><div class="doc"><p>Extract variables from a pattern.</p></div></div><div class="top"><p class="src"><a id="v:checkProgram" class="def">checkProgram</a> :: <a href="Syntax.html#t:Program" title="Syntax">Program</a> -&gt; [<a href="Semantic.html#t:Error" title="Semantic">Error</a>] <a href="src/Semantic.html#checkProgram" class="link">Source</a> <a href="#v:checkProgram" class="selflink">#</a></p><div class="doc"><p>Perform both semantic and type checking on a program.</p></div></div><div class="top"><p class="src"><a id="v:unifyReturn" class="def">unifyReturn</a> :: <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Infer" title="Semantic">Infer</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a> <a href="src/Semantic.html#unifyReturn" class="link">Source</a> <a href="#v:unifyReturn" class="selflink">#</a></p><div class="doc"><p>Unify expected and actual return types, allowing type variables.</p></div></div><div class="top"><p class="src"><a id="v:inferExpr" class="def">inferExpr</a> :: <a href="Semantic.html#t:FuncEnv" title="Semantic">FuncEnv</a> -&gt; <a href="Semantic.html#t:TypeEnv" title="Semantic">TypeEnv</a> -&gt; <a href="Syntax.html#t:Expr" title="Syntax">Expr</a> -&gt; <a href="Semantic.html#t:Infer" title="Semantic">Infer</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a> <a href="src/Semantic.html#inferExpr" class="link">Source</a> <a href="#v:inferExpr" class="selflink">#</a></p><div class="doc"><p>Infer the type of an expression.</p></div></div><div class="top"><p class="src"><a id="v:match" class="def">match</a> :: <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; Bool <a href="src/Semantic.html#match" class="link">Source</a> <a href="#v:match" class="selflink">#</a></p><div class="doc"><p>Match two types, allowing type variables.</p></div></div><div class="top"><p class="src"><a id="v:resolve" class="def">resolve</a> :: <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> <a href="src/Semantic.html#resolve" class="link">Source</a> <a href="#v:resolve" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:inferPattern" class="def">inferPattern</a> :: <a href="Syntax.html#t:Pattern" title="Syntax">Pattern</a> -&gt; <a href="Semantic.html#t:Infer" title="Semantic">Infer</a> ([(<a href="Syntax.html#t:Ident" title="Syntax">Ident</a>, <a href="Semantic.html#t:Type" title="Semantic">Type</a>)], <a href="Semantic.html#t:Type" title="Semantic">Type</a>) <a href="src/Semantic.html#inferPattern" class="link">Source</a> <a href="#v:inferPattern" class="selflink">#</a></p><div class="doc"><p>Infer types for pattern variables and return pattern type.</p></div></div><div class="top"><p class="src"><a id="v:literalType" class="def">literalType</a> :: <a href="Syntax.html#t:Literal" title="Syntax">Literal</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> <a href="src/Semantic.html#literalType" class="link">Source</a> <a href="#v:literalType" class="selflink">#</a></p><div class="doc"><p>Determine the type of a literal.</p></div></div><div class="top"><p class="src"><a id="v:numBin" class="def">numBin</a> :: <a href="Syntax.html#t:BinOperator" title="Syntax">BinOperator</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Infer" title="Semantic">Infer</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a> <a href="src/Semantic.html#numBin" class="link">Source</a> <a href="#v:numBin" class="selflink">#</a></p><div class="doc"><p>Type-check numeric binary operators.</p></div></div><div class="top"><p class="src"><a id="v:boolBin" class="def">boolBin</a> :: <a href="Syntax.html#t:BinOperator" title="Syntax">BinOperator</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Infer" title="Semantic">Infer</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a> <a href="src/Semantic.html#boolBin" class="link">Source</a> <a href="#v:boolBin" class="selflink">#</a></p><div class="doc"><p>Type-check boolean binary operators.</p><p>Type-check numeric binary operators.</p></div></div><div class="top"><p class="src"><a id="v:compBin" class="def">compBin</a> :: <a href="Syntax.html#t:BinOperator" title="Syntax">BinOperator</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Infer" title="Semantic">Infer</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a> <a href="src/Semantic.html#compBin" class="link">Source</a> <a href="#v:compBin" class="selflink">#</a></p><div class="doc"><p>Type-check comparison binary operators.</p><p>Type-check numeric binary operators.</p></div></div><div class="top"><p class="src"><a id="v:ensureBool" class="def">ensureBool</a> :: <a href="Syntax.html#t:Expr" title="Syntax">Expr</a> -&gt; <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; <a href="Semantic.html#t:Infer" title="Semantic">Infer</a> () <a href="src/Semantic.html#ensureBool" class="link">Source</a> <a href="#v:ensureBool" class="selflink">#</a></p><div class="doc"><p>Ensure an expression has boolean type.</p></div></div><div class="top"><p class="src"><a id="v:freshTypeVar" class="def">freshTypeVar</a> :: <a href="Semantic.html#t:Infer" title="Semantic">Infer</a> <a href="Semantic.html#t:Type" title="Semantic">Type</a> <a href="src/Semantic.html#freshTypeVar" class="link">Source</a> <a href="#v:freshTypeVar" class="selflink">#</a></p><div class="doc"><p>Generate a fresh type variable.</p></div></div><div class="top"><p class="src"><a id="v:isPoly" class="def">isPoly</a> :: <a href="Semantic.html#t:Type" title="Semantic">Type</a> -&gt; Bool <a href="src/Semantic.html#isPoly" class="link">Source</a> <a href="#v:isPoly" class="selflink">#</a></p><div class="doc"><p>Check if a type is polymorphic (a type variable).</p></div></div><div class="top"><p class="src"><a id="v:checkAll" class="def">checkAll</a> :: <a href="Syntax.html#t:Program" title="Syntax">Program</a> -&gt; [<a href="Semantic.html#t:Error" title="Semantic">Error</a>] <a href="src/Semantic.html#checkAll" class="link">Source</a> <a href="#v:checkAll" class="selflink">#</a></p><div class="doc"><p>Run full semantic and type checks on a program.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.25.1</p></div></body></html>